---
title: "TER - RÃ©sultats - rspan"
output:
  html_notebook:
    theme: default
    code_folding: hide
  pdf_document: 
    latex_engine: xelatex
---

```{r}

library(tidyverse)
library(ggpubr)
library(rstatix)

```

# RSPAN

## Phrases

```{r}

rspan <- read.csv2("data/rspan_dist.csv", sep = ",", fileEncoding="UTF-8-BOM")
rspan$part <- factor(rspan$part, levels = c("sentence-pre", "sentence-post", "recall-pre", "recall-post"))
rspan$size <- factor(rspan$size, levels = c("4.0", "5.0", "6.0"))
rspan$sim <- as.numeric(rspan$sim)
rspan$dsit <- as.numeric(rspan$dist)

recall <- rspan %>%
  filter(part != 'sentence-pre') %>%
  filter(part != 'sentence-post')

sent <- rspan %>%
  filter(part != 'recall-pre') %>%
  filter(part != 'recall-post')

sent %>%
  group_by(groupe, part) %>%
  get_summary_stats(correct)

```

```{r}

ggdensity(sent, x = "correct", fill = "part", facet.by = "groupe")

```


```{r}

ggbarplot(sent, x = "groupe", y = "correct", fill = "part", add = "mean_sd", position = position_dodge(0.8))

```


## Rappel

```{r}
recall %>%
  group_by(groupe, part) %>%
  get_summary_stats(sim)
```


```{r}

ggdensity(recall, x = "sim", fill = "part", facet.by = c("groupe", "size"))

```


```{r}

ggbarplot(recall, x = "groupe", y = "sim", fill = "part", add = "mean_sd", position = position_dodge(0.8))

```

```{r}

ggboxplot(recall, x = "size", y = "sim", fill = "part", facet.by = "groupe")

```


```{r}

ggbarplot(recall, x = "groupe", y = "sim", fill = "part", add = "mean_sd", position = position_dodge(0.8), facet.by = "size")

```


```{r}

recall %>%
  group_by(groupe) %>%
  wilcox_test(sim ~ part, paired = T)

```

```{r}

recall %>%
  group_by(groupe, size) %>%
  wilcox_test(sim ~ part, paired = T)

```


# ANOVA

## Phrases

```{r}
sent_ind <- sent %>%
  group_by(groupe, subject_id, part) %>%
  summarise_if(is.numeric, mean)

sent_ind %>%
  ungroup%>%
  anova_test(dv = correct, wid = subject_id, between = groupe, within = part) %>%
  get_anova_table()

```

### "Part" par "groupe"

```{r}
sent_ind %>%
  group_by(groupe) %>%
  anova_test(dv = correct, wid = subject_id, within = part) %>%
  get_anova_table()
```

## Recall

```{r}
sent_rec <- recall %>%
  group_by(groupe, subject_id, part) %>%
  summarise_if(is.numeric, mean)

sent_rec %>%
  ungroup%>%
  anova_test(dv = sim, wid = subject_id, between = groupe, within = part) %>%
  get_anova_table()
```

### "Part" par "groupe"

```{r}
sent_rec %>%
  group_by(groupe) %>%
  anova_test(dv = sim, wid = subject_id, within = part) %>%
  get_anova_table()
```









